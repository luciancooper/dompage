/* dompage v0.4
 * Copyright (c) 2017 Lucian Cooper
 */
!function(){const e=function(){function e(e){for(;e.parentElement&&"BODY"!==e.parentElement.tagName;){if(e.parentElement.id)return e.parentElement;e=e.parentElement}return null}function t(t,n){let l=e(t);for(;null!=l;){if(n.includes(l.id))return l.id;l=e(l)}}return function(e){let n=e.getAttribute("page-tabbed"),l=document.getElementById(n);if(!l)return void console.warn(`Could not set up tabs: element with id '${n}' does not exist in document`);let o={},i=Array.prototype.map.call(l.querySelectorAll("a[href^='#']"),e=>{let t=e.hash.slice(1),n=document.getElementById(t);if(null!==n)return n.classList.add("tab"),o[t]=e,t;e.classList.add("disabled")}).filter(e=>void 0!==e),s=document.forms.pagecontrol.appendChild(document.createElement("input"));var a;if(s.type="hidden",s.name="active_tab",window.location.hash){let e=window.location.hash.slice(1);e:if(i.includes(e))s.value=e;else{let n=document.getElementById(e);if(!n)break e;let l=t(n,i);if(!l)break e;s.value=l,a=n}}if(!s.value){if(!i.length)return;s.value=i[0]}document.getElementById(s.value).classList.toggle("active",!0),o[s.value].classList.add("selected"),a&&a.scrollIntoView(),window.addEventListener("hashchange",function(e){if(!window.location.hash)return;let n,l,a=window.location.hash.slice(1);if(i.includes(a))n=a;else{if(!(l=document.getElementById(a)))return;if(!(n=t(l,i)))return}s.value!==n&&(document.getElementById(s.value).classList.toggle("active",!1),document.getElementById(n).classList.toggle("active",!0),o[s.value].classList.toggle("selected",!1),o[s.value=n].classList.add("selected"),l&&l.scrollIntoView())})}}(),t=function(){return function(e,t,n){e.style.left=t.style.left,n.addEventListener("change",function(e){this.style.left=e.style.left}.bind(e,t)),n.addEventListener("resize",function(e,t){t.target.checked&&(this.style.left=e.style.left)}.bind(e,t))}}(),n=function(){return function(e,t,n){e.style.right=t.style.right,n.addEventListener("change",function(e){this.style.right=e.style.right}.bind(e,t)),n.addEventListener("resize",function(e,t){t.target.checked&&(this.style.right=e.style.right)}.bind(e,t))}}(),l=function(){return function(e,t,n){e.style.bottom=t.style.bottom,n.addEventListener("change",function(e){this.style.bottom=e.style.bottom}.bind(e,t)),n.addEventListener("resize",function(e,t){t.target.checked&&(this.style.bottom=e.style.bottom)}.bind(e,t))}}();const o=function(){const e={left:function(e,t,n){n.addEventListener("change",function(e,t){let n=t.target.checked;Array.prototype.forEach.call(t.target.labels,e=>e.classList.toggle("selected",n)),e.style.display=n?"":"none",this.style.left=n?e.offsetWidth+e.offsetLeft+"px":"0"}.bind(e,t)),n.addEventListener("resize",function(e,t){t.target.checked&&(this.style.left=e.offsetWidth+e.offsetLeft+"px")}.bind(e,t)),t.style.bottom=t.style.top=t.style.left="0",e.style.left=n.checked?t.offsetWidth+t.offsetLeft+"px":"0"},right:function(e,t,n){n.addEventListener("change",function(e,t){let n=t.target.checked;Array.prototype.forEach.call(t.target.labels,e=>e.classList.toggle("selected",n)),e.style.display=n?"":"none",this.style.right=n?e.parentElement.offsetWidth-e.offsetLeft+"px":"0"}.bind(e,t)),n.addEventListener("resize",function(e,t){t.target.checked&&(this.style.right=e.parentElement.offsetWidth-e.offsetLeft+"px")}.bind(e,t)),t.style.bottom=t.style.top=t.style.right="0",e.style.right=n.checked?t.parentElement.offsetWidth-t.offsetLeft+"px":"0"},bottom:function(e,t,n){n.addEventListener("change",function(e,t){let n=t.target.checked;Array.prototype.forEach.call(t.target.labels,e=>e.classList.toggle("selected",n)),e.style.display=n?"":"none",this.style.bottom=n?e.parentElement.offsetHeight-e.offsetTop+"px":"0"}.bind(e,t)),n.addEventListener("resize",function(e,t){t.target.checked&&(this.style.bottom=e.parentElement.offsetHeight-e.offsetTop+"px")}.bind(e,t)),t.style.left=t.style.right=t.style.bottom="0",e.style.bottom=n.checked?t.parentElement.offsetHeight-t.offsetTop+"px":"0"}},o=function(){function e(e,t){var n=20;return e.hasAttribute("pct")&&((n=parseInt(e.getAttribute("pct")))<0||n>100)&&(console.warn(`Invalid value '${n}' provided for ${t} flex panel 'pct', must be number between 0 - 100, using default 20`),n=20),e.setAttribute("pct",n),n}return{left:function(){return function(t,n,l){l.addEventListener("change",function(e,t){let n=t.target.checked;Array.prototype.forEach.call(t.target.labels,e=>e.classList.toggle("selected",n)),e.style.display=n?"":"none",this.style.left=n?e.getAttribute("pct")+"%":"0"}.bind(t,n)),l.addEventListener("resize",function(e,t){let n=parseInt(e.getAttribute("pct"));e.style.right=`${100-n}%`,t.target.checked&&(this.style.left=`${n}%`)}.bind(t,n)),n.style.bottom=n.style.top=n.style.left=n.style.marginRight="0";var o=e(n,"left");n.style.right=`${100-o}%`,t.style.left=l.checked?`${o}%`:"0"}}(),right:function(){return function(t,n,l){l.addEventListener("change",function(e,t){let n=t.target.checked;Array.prototype.forEach.call(t.target.labels,e=>e.classList.toggle("selected",n)),e.style.display=n?"":"none",this.style.right=n?e.getAttribute("pct")+"%":"0"}.bind(t,n)),l.addEventListener("resize",function(e,t){let n=parseInt(e.getAttribute("pct"));e.style.left=`${100-n}%`,t.target.checked&&(this.style.right=`${n}%`)}.bind(t,n)),n.style.bottom=n.style.top=n.style.right=n.style.marginLeft="0";var o=e(n,"right");n.style.left=`${100-o}%`,t.style.right=l.checked?`${o}%`:"0"}}(),bottom:function(){return function(t,n,l){l.addEventListener("change",function(e,t){let n=t.target.checked;Array.prototype.forEach.call(t.target.labels,e=>e.classList.toggle("selected",n)),e.style.display=n?"":"none",this.style.bottom=n?e.getAttribute("pct")+"%":"0"}.bind(t,n)),l.addEventListener("resize",function(e,t){let n=parseInt(e.getAttribute("pct"));e.style.top=`${100-n}%`,t.target.checked&&(this.style.bottom=`${n}%`)}.bind(t,n)),n.style.left=n.style.right=n.style.bottom=n.style.marginTop="0";var o=e(n,"bottom");n.style.top=`${100-o}%`,t.style.bottom=l.checked?`${o}%`:"0"}}()}}();return function(i,s,a){let d=document.getElementById(s);if(null===d)return console.warn(`Could not set up ${a} panel: element with id '${s}' does not exist in document`),!1;d.classList.add("page-panel-"+a),d.style.position="fixed",d.style.backfaceVisibility="hidden";let c=document.createElement("input");c.type="checkbox",c.value=s,c.name=a,c.id="pagectrl_"+a,d.classList.contains("hidden")?(d.style.display="none",d.classList.remove("hidden"),c.checked=!1):c.checked=!0,document.forms.pagecontrol.appendChild(c),d.hasAttribute("page-panel")||d.setAttribute("page-panel","auto");var r=d.getAttribute("page-panel");switch(r){case"flex":o[a](i,d,c);break;default:"auto"!==r&&(console.warn(`Invalid page-panel attribute '${r}', using default type 'auto'`),d.setAttribute("page-panel","auto")),e[a](i,d,c)}if(d.hasAttribute("hide-toggle")&&function(e,t){let n=e.getAttribute("hide-toggle");if(n){var l=document.getElementById(n);if(null!==l)return"LABEL"==l.tagName?null===l.control?(l.htmlFor=t.id,void l.classList.toggle("selected",t.checked)):"INPUT"!==l.control.tagName||"checkbox"!==l.control.type?void console.warn(`Could not set up hide toggle button for ${t.name} panel: label must be for an input[type='checkbox']`):(l.control.checked=t.checked,l.classList.toggle("selected",t.checked),void l.control.addEventListener("change",function(e){Array.prototype.forEach.call(e.target.labels,t=>t.classList.toggle("selected",e.target.checked)),this.checked=e.target.checked,this.dispatchEvent(new Event("change",{bubbles:!1,cancelable:!1,composed:!1}))}.bind(t))):void("INPUT"===l.tagName&&"checkbox"===l.type?(l.checked=t.checked,l.addEventListener("change",function(e){this.checked=e.target.checked,this.dispatchEvent(new Event("change",{bubbles:!1,cancelable:!1,composed:!1}))}.bind(t))):console.warn(`Could not set up hide toggle button for ${t.name} panel: element must be of type input[type='checkbox']`));console.warn(`Could not set up hide toggle button for ${t.name} panel: element with id '${n}' does not exist in document`)}else console.warn(`Could not set up hide toggle button for ${t.name} panel: no element id provided`)}(d,c),"bottom"===a){let e=d.hasAttribute("yield")?d.getAttribute("yield").split(","):[],o=document.forms.pagecontrol.elements.namedItem("left");null!==o&&(e.includes("left")?t(d,i,o):l(document.getElementById(o.value),i,c));let s=document.forms.pagecontrol.elements.namedItem("right");null!==s&&(e.includes("right")?n(d,i,s):l(document.getElementById(s.value),i,c))}return!0}}();var i;document.addEventListener("readystatechange",(i=!1,function(l){if(i)return;if(!document.body.hasAttribute("page-main"))return;document.body.classList.contains("loading")||document.body.classList.add("loading");let s=document.body.getAttribute("page-main"),a=document.getElementById(s);if(null===a)return void("complete"==l.target.readyState&&(console.warn(`Could not set up page: element with id '${s}' does not exist in document`),document.body.classList.remove("loading"),document.body.removeAttribute("page-main")));a.classList.add("page-main"),a.style.position="fixed",a.style.backfaceVisibility="hidden",a.style.top=a.style.bottom=a.style.left=a.style.right="0";let d=document.createElement("form");d.id="pagecontrol",d.style.display="none",document.body.insertBefore(d,document.body.firstChild),document.body.hasAttribute("page-panel-left")&&(o(a,document.body.getAttribute("page-panel-left"),"left")||document.body.removeAttribute("page-panel-left")),document.body.hasAttribute("page-panel-right")&&(o(a,document.body.getAttribute("page-panel-right"),"right")||document.body.removeAttribute("page-panel-right")),document.body.hasAttribute("page-panel-bottom")&&(o(a,document.body.getAttribute("page-panel-bottom"),"bottom")||document.body.removeAttribute("page-panel-bottom")),document.body.hasAttribute("page-topbar")&&function(e,l,o){let i=document.getElementById(o);if(null===i)return void console.warn(`Could not set up topbar: element with id '${o}' does not exist in document`);i.classList.add("page-topbar"),i.style.position="fixed",i.style.top=i.style.left=i.style.right="0",e.style.top=i.offsetHeight+i.offsetTop+"px";let s=i.hasAttribute("yield")?i.getAttribute("yield").split(","):[],a=l.elements.namedItem("left");a&&(s.includes("left")?t(i,e,a):document.getElementById(a.value).style.top=e.style.top);let d=l.elements.namedItem("right");d&&(s.includes("right")?n(i,e,d):document.getElementById(d.value).style.top=e.style.top)}(a,d,document.body.getAttribute("page-topbar")),a.hasAttribute("page-tabbed")&&e(a),i=!0,document.body.classList.remove("loading"),document.body.setAttribute("setup-complete","")}))}();